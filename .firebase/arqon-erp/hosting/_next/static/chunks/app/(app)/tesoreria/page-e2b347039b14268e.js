(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1320],{2709:(e,t,s)=>{Promise.resolve().then(s.bind(s,4349))},4349:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var a=s(5155),r=s(2115);function n(){let[e,t]=(0,r.useState)([]),[s,n]=(0,r.useState)(null),[l,i]=(0,r.useState)(!1),[o,c]=(0,r.useState)(null),[d,u]=(0,r.useState)("ingreso"),[h,m]=(0,r.useState)(0),[p,x]=(0,r.useState)("efectivo"),[g,j]=(0,r.useState)("");async function N(){i(!0);try{let e=await fetch("/api/caja?limit=50",{cache:"no-store"}),s=await e.json();s.ok?(t(s.data||[]),n(s.tot||null)):c(s.error||"Error al consultar")}catch(e){c(e.message||"Error de red")}finally{i(!1)}}async function f(e){if(e.preventDefault(),c(null),!g||!h)return void c("Complet\xe1 descripci\xf3n y monto.");try{let e=await fetch("/api/caja",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tipo:d,monto:h,medio:p,descripcion:g})}),t=await e.json();t.ok?(j(""),m(0),await N(),c("âœ… Movimiento registrado")):c(t.error||"No se pudo guardar")}catch(e){c(e.message||"Error de red")}}(0,r.useEffect)(()=>{N()},[]);let b=(0,r.useMemo)(()=>s?"Ingresos $".concat(s.ingresos.toFixed(2)," \xb7 Egresos $").concat(s.egresos.toFixed(2)," \xb7 Saldo $").concat(s.saldo.toFixed(2)):"",[s]);return(0,a.jsxs)("main",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex items-end justify-between",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold",children:"Tesorer\xeda"}),(0,a.jsx)("p",{className:"text-neutral-400 text-sm",children:b})]})}),(0,a.jsxs)("form",{onSubmit:f,className:"rounded-lg border border-neutral-800 bg-neutral-900 p-4 grid sm:grid-cols-5 gap-3",children:[(0,a.jsxs)("select",{value:d,onChange:e=>u(e.target.value),className:"rounded-md bg-neutral-950 px-3 py-2 ring-1 ring-neutral-800",children:[(0,a.jsx)("option",{value:"ingreso",children:"Ingreso"}),(0,a.jsx)("option",{value:"egreso",children:"Egreso"})]}),(0,a.jsx)("input",{value:h||"",onChange:e=>m(Number(e.target.value)),type:"number",step:"0.01",placeholder:"Monto",className:"rounded-md bg-neutral-950 px-3 py-2 ring-1 ring-neutral-800"}),(0,a.jsx)("input",{value:p,onChange:e=>x(e.target.value),placeholder:"Medio (efectivo, transferencia...)",className:"rounded-md bg-neutral-950 px-3 py-2 ring-1 ring-neutral-800"}),(0,a.jsx)("input",{value:g,onChange:e=>j(e.target.value),placeholder:"Descripci\xf3n",className:"rounded-md bg-neutral-950 px-3 py-2 ring-1 ring-neutral-800 sm:col-span-2"}),(0,a.jsx)("button",{className:"rounded-md bg-emerald-600 px-4 py-2 font-medium",children:"Guardar"})]}),o&&(0,a.jsx)("p",{className:"text-sm text-neutral-300",children:o}),(0,a.jsx)("div",{className:"rounded-lg border border-neutral-800 overflow-hidden",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{className:"bg-neutral-900/60",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left p-2",children:"Fecha"}),(0,a.jsx)("th",{className:"text-left p-2",children:"Tipo"}),(0,a.jsx)("th",{className:"text-right p-2",children:"Monto"}),(0,a.jsx)("th",{className:"text-left p-2",children:"Medio"}),(0,a.jsx)("th",{className:"text-left p-2",children:"Descripci\xf3n"})]})}),(0,a.jsxs)("tbody",{children:[e.map(e=>{var t;return(0,a.jsxs)("tr",{className:"border-t border-neutral-800",children:[(0,a.jsx)("td",{className:"p-2",children:(null==(t=e.fecha)?void 0:t.seconds)?new Date(1e3*e.fecha.seconds).toLocaleString():"-"}),(0,a.jsx)("td",{className:"p-2",children:e.tipo}),(0,a.jsxs)("td",{className:"p-2 text-right",children:["$",Number(e.monto||0).toFixed(2)]}),(0,a.jsx)("td",{className:"p-2",children:e.medio}),(0,a.jsx)("td",{className:"p-2",children:e.descripcion})]},e.id)}),0===e.length&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"p-3 text-neutral-500",colSpan:5,children:"Sin movimientos a\xfan."})})]})]})})]})}}},e=>{e.O(0,[8441,1255,7358],()=>e(e.s=2709)),_N_E=e.O()}]);